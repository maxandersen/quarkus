ifdef::context[:parent-context: {context}]
[id="the-price-converter_{context}"]
= The price converter
:context: the-price-converter

The price converter reads the prices from AMQP, and transforms them.
Create the `src/main/java/org/acme/amqp/PriceConverter.java` file with the following content:

[source,java]
----
package org.acme.amqp;

import io.smallrye.reactive.messaging.annotations.Broadcast;
import org.eclipse.microprofile.reactive.messaging.Incoming;
import org.eclipse.microprofile.reactive.messaging.Outgoing;

import javax.enterprise.context.ApplicationScoped;

/**
 * A bean consuming data from the "prices" AMQP queue and applying some conversion.
 * The result is pushed to the "my-data-stream" stream which is an in-memory stream.
 */
@ApplicationScoped
public class PriceConverter {

    private static final double CONVERSION_RATE = 0.88;

    @Incoming("prices")                                  // <1>
    @Outgoing("my-data-stream")                          // <2>
    @Broadcast                                           // <3>
    public double process(int priceInUsd) {
        return priceInUsd * CONVERSION_RATE;
    }

}

----

[arabic]
<1> Indicates that the method consumes the items from the `prices` channel
<2> Indicates that the objects returned by the method are sent to the `my-data-stream` channel
<3> Indicates that the item are dispatched to all _subscribers_

The `process` method is called for every AMQP messages from the `prices` queue (configured in the application configuration).
Every result is sent to the `my-data-stream` in-memory stream.


ifdef::parent-context[:context: {parent-context}]
ifndef::parent-context[:!context:]